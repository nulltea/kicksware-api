version: '3.3'
services:
  web-app:
    build:
      context: .
      dockerfile: ./docker/Dockerfile
    image: web-app
    restart: always
    env_file: ./env/.env
    labels:
      - traefik.http.routers.web-app.rule=Host(`kicksware.com`)
      - traefik.http.routers.web-app.tls=true
      - traefik.http.routers.web-app.tls.certresolver=le
      - traefik.docker.network=web
    networks:
      - web
    volumes:
      - type: bind
        source: storage-volume
        target: /source/storage

volumes:
  storage-volume:
    driver: local
    driver_opts:
       o: bind
       type: none
       device: /source/storage

networks:
  web:
    external: true
